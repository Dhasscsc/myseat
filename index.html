<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TGT Main2 Pro</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #0d1117; color: #c9d1d9; text-align: center; padding: 10px; margin: 0; }
        .box { background: #161b22; border-radius: 12px; padding: 15px; margin: 10px auto; max-width: 500px; border: 1px solid #30363d; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 10px; }
        .card { padding: 10px; border-radius: 6px; font-weight: bold; font-size: 0.85rem; border: 1px solid rgba(255,255,255,0.05); }
        .BUY-tag { background: #238636; color: white; }
        .SELL-tag { background: #da3633; color: white; }
        .WAIT-tag { background: #30363d; color: #8b949e; }
        .btn { background: #58a6ff; color: black; border: none; padding: 12px; width: 100%; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 1rem; }
        .count { float: right; background: rgba(0,0,0,0.2); padding: 0 8px; border-radius: 10px; }
        h3 { margin: 5px 0; text-align: left; font-size: 1.1rem; }
    </style>
</head>
<body>

    <h2 style="color: #58a6ff; margin-top: 20px;">TGT Main2 LIVE</h2>
    
    <div class="box">
        <button class="btn" id="sndBtn" onclick="initAudio()">ЁЯФФ роЪро╡рпБрогрпНроЯрпН роЕро▓ро░рпНроЯрпН роЖроХрпНроЯро┐ро╡рпЗроЯрпН роЪрпЖропрпН</button>
    </div>

    <div id="displayArea">родро░ро╡рпБроХро│рпН рокрпБродрпБрокрпНрокро┐роХрпНроХрокрпНрокроЯрпБроХро┐ройрпНро▒рой...</div>

    <script>
        const url = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSDDw_0R5I72Kp1RSTOTaJEGmAEUBInSF_bSneyvtb1sc-UED_3y7jbBAIC22rp2sUWSLowZ9C5Ri2l/pub?gid=1778670401&single=true&output=csv';
        
        let audioOn = false;
        let lastSignals = {};
        const beep = new Audio('https://actions.google.com/sounds/v1/alarms/beep_short.ogg');

        function initAudio() {
            audioOn = true;
            document.getElementById('sndBtn').innerText = "ЁЯФК роЪро╡рпБрогрпНроЯрпН роЕро▓ро░рпНроЯрпН роЖройрпН роЪрпЖропрпНропрокрпНрокроЯрпНроЯрпБро│рпНро│родрпБ";
            document.getElementById('sndBtn').style.background = "#238636";
            document.getElementById('sndBtn').style.color = "white";
        }

        async function updateDashboard() {
            try {
                const response = await fetch(url + '&t=' + Date.now());
                const csvText = await response.text();
                const lines = csvText.split('\n');
                
                let buyH = '', sellH = '', waitH = '';
                let bc = 0, sc = 0, wc = 0;

                for (let i = 1; i < lines.length; i++) {
                    const col = lines[i].split(',');
                    if (col.length < 5) continue;

                    let stock = col[3] ? col[3].replace(/"/g, '').trim() : '';
                    let signal = col[4] ? col[4].replace(/"/g, '').trim().toUpperCase() : '';

                    // роХро╛ро▓ро┐ропро╛рой рокрпЖропро░рпНроХро│рпИродрпН родро╡ро┐ро░рпНроХрпНроХро╡рпБроорпН (роЗроЩрпНроХрпБродро╛ройрпН роЙроЩрпНроХро│рпН родро╡ро▒рпБ роЪро░ро┐ роЪрпЖропрпНропрокрпНрокроЯрпБроХро┐ро▒родрпБ)
                    if (!stock || stock === "" || stock === "STOCK") continue;

                    let tag = `<div class="card ${signal}-tag">${stock}</div>`;

                    if (signal === 'BUY') { buyH += tag; bc++; }
                    else if (signal === 'SELL') { sellH += tag; sc++; }
                    else { waitH += tag; wc++; }

                    // роЪро┐роХрпНройро▓рпН рооро╛ро▒ро┐ройро╛ро▓рпН роЪродрпНродроорпН (WAIT-ро▓ро┐ро░рпБроирпНродрпБ рооро╛ро▒ро┐ройро╛ро▓рпН роороЯрпНроЯрпБроорпН)
                    if (audioOn && lastSignals[stock] && lastSignals[stock] !== signal) {
                        if (signal === 'BUY' || signal === 'SELL') beep.play();
                    }
                    lastSignals[stock] = signal;
                }

                document.getElementById('displayArea').innerHTML = `
                    <div class="box"><h3 style="color:#39d353">BUY <span class="count">${bc}</span></h3><div class="grid">${buyH || 'роЗро▓рпНро▓рпИ'}</div></div>
                    <div class="box"><h3 style="color:#f85149">SELL <span class="count">${sc}</span></h3><div class="grid">${sellH || 'роЗро▓рпНро▓рпИ'}</div></div>
                    <div class="box"><h3 style="color:#8b949e">WAIT <span class="count">${wc}</span></h3><div class="grid">${waitH || 'роЗро▓рпНро▓рпИ'}</div></div>
                `;
            } catch (e) {
                document.getElementById('displayArea').innerHTML = "роЗрогрпИрокрпНрокродро┐ро▓рпН роЪро┐роХрпНроХро▓рпН... роорпАрогрпНроЯрпБроорпН роорпБропро▒рпНроЪро┐роХрпНроХро╡рпБроорпН.";
            }
        }

        setInterval(updateDashboard, 10000); // 10 ро╡ро┐роиро╛роЯро┐роХрпНроХрпБ роТро░рпБроорпБро▒рпИ
        updateDashboard();
    </script>
</body>
</html>